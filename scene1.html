<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>åœºæ™¯ä¸€ - æ²‰é»˜æ¡£æ¡ˆï¼š2586</title>
    <link rel="stylesheet" href="styles.css"/>
    <style>
        body {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: #000;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
        }
        
        .video-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
        }
        
        .video-bg {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .scene-content {
            position: absolute;
            top: 50px;
            left: 50px;
            color: #fff;
            text-shadow: none;
            z-index: 2;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 10px;
        }

        .scene-content h1 {
            margin: 0;
            font-size: 24px;
            color: #fff;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
        }

        .dialogue-btn {
            position: absolute;
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
            transition: all 0.3s ease;
            z-index: 2;
        }

        .dialogue-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.05);
        }

        /* æ ¹æ®å›¾ç‰‡ä¸­äººç‰©çš„ä½ç½®è°ƒæ•´æŒ‰é’®ä½ç½® */
        .btn-1 {
            top: 25%;
            left: 25%;
        }

        .btn-2 {
            top: 35%;
            left: 50%;
        }

        .btn-3 {
            top: 50%;
            left: 73%;
        }

        .dialogue-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -58%);
            width: 80%;
            max-width: 800px;
            background: rgba(0, 0, 0, 0.8);
            color: #fff;
            padding: 30px;
            border-radius: 10px;
            font-size: 20px;
            line-height: 1.6;
            z-index: 3;
            display: none;
            text-align: left;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .version-buttons {
            position: fixed;
            top: calc(50% + 200px);
            left: 50%;
            transform: translateX(-50%);
            display: none;
            justify-content: center;
            gap: 20px;
            z-index: 3;
        }

        .version-btn {
            background: rgba(255, 255, 255, 0.2);
            color: #fff;
            border: 1px solid #fff;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .version-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        #debug-info {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 4;
        }

        .next-page-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: rgba(0, 0, 0, 0.7);
            border: 2px solid #fff;
            border-radius: 50%;
            cursor: pointer;
            z-index: 4;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            font-size: 30px;
            color: #fff;
            padding: 0;
            line-height: 1;
        }

        .next-page-btn:hover {
            background: rgba(0, 0, 0, 0.9);
            transform: scale(1.1);
        }

        .next-page-btn::after {
            content: 'â¤';
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        /* æ·»åŠ ç³»ç»Ÿæç¤ºè¯æ ·å¼ */
        .system-prompt {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-size: 24px;
            text-align: center;
            padding: 15px 30px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            z-index: 10;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
        }

        /* æ·»åŠ ç‰ˆæœ¬æ ‡è¯†å’Œæ­£æ–‡çš„æ ·å¼ */
        .version-label {
            margin-bottom: 2px !important;
        }

        .version-content {
            margin-top: 2px !important;
        }

        /* æ·»åŠ é€‰æ‹©æç¤ºæ–‡æœ¬çš„æ ·å¼ */
        .choice-prompt {
            position: relative;
            color: #fff;
            font-size: 18px;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
            text-align: center;
            z-index: 3;
            margin-bottom: 0px;
        }

        .choice-container {
            position: fixed;
            top: calc(50% + 170px);
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.1);
            padding: 20px 40px;
            border-radius: 10px;
            z-index: 3;
            border: 2px solid rgba(255, 255, 255, 0.3);
            opacity: 0; /* åˆå§‹é€æ˜åº¦ä¸º0 */
            visibility: hidden; /* åˆå§‹éšè— */
            transition: opacity 0.5s ease-out, visibility 0.5s ease-out; /* å¹³æ»‘è¿‡æ¸¡ */
        }

        .choice-container.show {
            opacity: 1;
            visibility: visible;
        }

        .version-buttons {
            position: relative;
            display: flex; /* å§‹ç»ˆflexï¼Œç”±çˆ¶å®¹å™¨æ§åˆ¶å¯è§æ€§ */
            justify-content: center;
            gap: 20px;
            z-index: 3;
        }

        /* æ–°å¢é€‰æ‹©ç»“æœæç¤ºæ¡†æ ·å¼ */
        .selection-result-box {
            position: fixed;
            bottom: -100px; /* åˆå§‹ä½ç½®åœ¨å±å¹•ä¸‹æ–¹ï¼Œéšè— */
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: #fff;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 18px;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
            z-index: 5;
            opacity: 0; /* åˆå§‹é€æ˜åº¦ä¸º0 */
            transition: bottom 0.5s ease-out, opacity 0.5s ease-out; /* å¹³æ»‘è¿‡æ¸¡æ•ˆæœ */
            text-align: center;
        }

        .selection-result-box.show {
            bottom: 30px; /* æ˜¾ç¤ºæ—¶ä¸Šç§»åˆ°å±å¹•åº•éƒ¨ */
            opacity: 1;
        }

        .letter-content {
            font-size: 1.2em;
            line-height: 1.8;
            color: #333;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
            white-space: pre-line;
            margin-bottom: 2em;
        }

        .letter-after-text {
            font-style: italic;
            color: #666;
            text-align: center;
            font-family: "æ¥·ä½“", "KaiTi", "STKaiti", serif;
            margin-top: 2em;
            padding-top: 1em;
            border-top: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="video-container">
        <video id="bgVideo" class="video-bg" muted loop playsinline>
            <source src="assets/scene1.mp4" type="video/mp4">
            æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè§†é¢‘æ’­æ”¾ã€‚
        </video>
    </div>

    <!-- æ·»åŠ èƒŒæ™¯éŸ³ä¹ -->
    <audio id="bgm" loop>
        <source src="assets/audio/main_bgm.mp3" type="audio/mpeg">
    </audio>

    <!-- æ·»åŠ å¯¹è¯éŸ³é¢‘ -->
    <audio id="scene1_dialogue1_version1" src="assets/audio/scene1/dialogue1_version1.mp3"></audio>
    <audio id="scene1_dialogue1_version2" src="assets/audio/scene1/dialogue1_version2.mp3"></audio>
    <audio id="scene1_dialogue2_version1" src="assets/audio/scene1/dialogue2_version1.mp3"></audio>
    <audio id="scene1_dialogue2_version2" src="assets/audio/scene1/dialogue2_version2.mp3"></audio>
    <audio id="scene1_dialogue3_version1" src="assets/audio/scene1/dialogue3_version1.mp3"></audio>
    <audio id="scene1_dialogue3_version2" src="assets/audio/scene1/dialogue3_version2.mp3"></audio>

    <div class="scene-content">
        <h1>åœºæ™¯ä¸€ï¼šé‚®å±€</h1>
    </div>

    <!-- æ·»åŠ ç³»ç»Ÿæç¤ºè¯ -->
    <div class="system-prompt">è¯·ä»»æ„ç‚¹å‡»å¯¹è¯è·å¾—çº¿ç´¢</div>

    <button class="dialogue-btn btn-1">å¯¹è¯ä¸€</button>
    <button class="dialogue-btn btn-2">å¯¹è¯äºŒ</button>
    <button class="dialogue-btn btn-3">å¯¹è¯ä¸‰</button>

    <div id="dialogueBox" class="dialogue-box">
        <div id="dialogueText"></div>
    </div>

    <div class="choice-container">
        <div class="choice-prompt">ä½ é€‰æ‹©ç›¸ä¿¡å“ªä¸€ç‰ˆæœ¬ï¼Ÿ</div>
        <div class="version-buttons">
            <button class="version-btn" id="unofficialBtn">ç‰ˆæœ¬ä¸€</button>
            <button class="version-btn" id="officialBtn">ç‰ˆæœ¬äºŒ</button>
        </div>
    </div>

    <div id="debug-info"></div>

    <!-- æ·»åŠ æ–°çš„é€‰æ‹©ç»“æœæç¤ºæ¡† -->
    <div id="selectionResultBox" class="selection-result-box">
        <p id="selectionResultMessage"></p>
    </div>

    <button class="next-page-btn" id="nextPageBtn" title="ä¸‹ä¸€é¡µ"></button>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const video = document.getElementById('bgVideo');
            const bgm = document.getElementById('bgm');
            const debugInfo = document.getElementById('debug-info');
            const dialogueBox = document.getElementById('dialogueBox');
            const dialogueText = document.getElementById('dialogueText');
            const unofficialBtn = document.getElementById('unofficialBtn');
            const officialBtn = document.getElementById('officialBtn');
            const nextPageBtn = document.getElementById('nextPageBtn');
            const selectionResultBox = document.getElementById('selectionResultBox');
            const selectionResultMessage = document.getElementById('selectionResultMessage');
            
            let currentActiveDialogueNum = null; // æ–°å¢ï¼šè®°å½•å½“å‰æ´»è·ƒçš„å¯¹è¯ç¼–å·

            // åˆå§‹åŒ–éŸ³é¢‘å…ƒç´ æ•°ç»„ï¼Œç¡®ä¿åœ¨æ‰€æœ‰ç›¸å…³å‡½æ•°ä¹‹å‰å£°æ˜
            let dialogueAudioElements = [];

            // æ·»åŠ éŸ³é¢‘æ’­æ”¾å‡½æ•°
            function playVersion1Audio(dialogueNum) {
                // åªåœæ­¢å¯¹è¯éŸ³é¢‘ï¼Œä¸å½±å“èƒŒæ™¯éŸ³ä¹
                stopDialogueAudio();
                
                // åˆ›å»ºæ–°çš„éŸ³é¢‘å…ƒç´ 
                const audio = new Audio(`assets/audio/scene1/dialogue${dialogueNum}_version1.mp3`);
                audio.play().catch(e => console.error("Error playing version 1 audio:", e));
                
                // å°†éŸ³é¢‘å…ƒç´ æ·»åŠ åˆ°æ•°ç»„ä¸­ä»¥ä¾¿åç»­ç®¡ç†
                dialogueAudioElements.push(audio);
            }

            function playVersion2Audio(dialogueNum) {
                // åªåœæ­¢å¯¹è¯éŸ³é¢‘ï¼Œä¸å½±å“èƒŒæ™¯éŸ³ä¹
                stopDialogueAudio();
                
                // åˆ›å»ºæ–°çš„éŸ³é¢‘å…ƒç´ 
                const audio = new Audio(`assets/audio/scene1/dialogue${dialogueNum}_version2.mp3`);
                audio.play().catch(e => console.error("Error playing version 2 audio:", e));
                
                // å°†éŸ³é¢‘å…ƒç´ æ·»åŠ åˆ°æ•°ç»„ä¸­ä»¥ä¾¿åç»­ç®¡ç†
                dialogueAudioElements.push(audio);
            }

            // åœæ­¢æ‰€æœ‰å¯¹è¯éŸ³é¢‘çš„å‡½æ•°ï¼ˆä¸å½±å“èƒŒæ™¯éŸ³ä¹ï¼‰
            function stopDialogueAudio() {
                dialogueAudioElements.forEach(audio => {
                    if (audio) {
                        audio.pause();
                        audio.currentTime = 0;
                    }
                });
                dialogueAudioElements = []; // æ¸…ç©ºæ•°ç»„
            }
            
            // å¯¹è¯å†…å®¹
            const dialogues = {
                'btn-1': {
                    text1: "ç»è¿‡ä¸€æ®µæ—¶é—´çš„å…¨åŠ›æŠ¢ä¿®ï¼Œå—ç¾æ ¸å¿ƒåŒºåŸŸçš„ç”µåŠ›ä¸é€šè®¯å·²åŸºæœ¬æ¢å¤æ­£å¸¸è¿è¡Œï¼Œç›®å‰ä»…å‰©å°‘æ•°åè¿œåœ°åŒºä»åœ¨é€æ­¥æ¢å¤ä¸­ã€‚è™½ç„¶è¿™äº›åŒºåŸŸçš„ç½‘ç»œä¿¡å·å°šå­˜åœ¨çŸ­æš‚å»¶è¿Ÿï¼Œä½†æˆ‘ä»¬ç›¸ä¿¡åœ¨æŠ¢ä¿®äººå‘˜çš„æŒç»­åŠªåŠ›ä¸‹ï¼Œå…¨é¢è¦†ç›–æŒ‡æ—¥å¯å¾…ã€‚",
                    text2: "å¾ˆå¤šåœ°æ–¹çš„ç”µåŠ›ä¾ç„¶æœªæ¢å¤ï¼Œè¿æœ€åŸºæœ¬çš„é€šä¿¡éƒ½ä¸­æ–­äº†ã€‚æœ‰äº›åœ°æ–¹å‡ ä¹æ²¡ä»€ä¹ˆæ•‘æ´ã€‚æˆ‘ä»¬æ‹¿åˆ°çš„èµ„æºæ˜¯è¢«å‹ç¼©çš„ï¼Œæˆ‘ä»¬èƒ½åšçš„åªä¸è¿‡æ˜¯åº”ä»˜ä¸Šçº§è¦æ±‚çš„æŠ¥å‘Šã€‚"
                },
                'btn-2': {
                    text1: "åœ¨ç»è¿‡å¿«é€Ÿç­›æŸ¥åï¼Œæˆ‘ä»¬æˆåŠŸä¸ºæ‰€æœ‰ä¼¤å‘˜æä¾›äº†ç´§æ€¥æ•‘æ²»ã€‚éšç€åç»­æ”¯æ´çš„åˆ°æ¥ï¼Œæˆ‘ä»¬ä¼šç»§ç»­ä¿æŒæ•‘æ´çš„åŠ›åº¦ï¼Œç¡®ä¿æ‰€æœ‰å—ä¼¤äººå‘˜å¾—åˆ°æ²»ç–—ã€‚",
                    text2: "å¾ˆå¤šä¼¤å‘˜è¢«è¿«ç­‰å¾…å¾ˆé•¿æ—¶é—´ï¼Œä»–ä»¬çš„æƒ…å†µæ²¡æœ‰è¢«åŠæ—¶è¯„ä¼°ã€‚éƒ¨åˆ†è¿œç¦»åŒ»ç–—ç«™çš„ä¼¤å‘˜ç”šè‡³è¿åŸºç¡€çš„è¯ç‰©éƒ½æ²¡æœ‰æ‹¿åˆ°ã€‚å®˜æ–¹æŠ¥å‘Šè¯´æ²»ç–—è¿›è¡Œäº†ï¼Œä½†æˆ‘ä»¬çŸ¥é“ï¼Œæœ‰äº›äººçš„ç—…æƒ…è¢«å¿½è§†ã€‚"
                },
                'btn-3': {
                    text1: "ç‰©èµ„åˆ†é…ä¸æ˜¯å¾ˆå¹³è¡¡ï¼Œæœ‰ä¸€å¤§éƒ¨åˆ†çš„é‡éš¾äººç¾¤æ‹¿ä¸åˆ°é£Ÿç‰©å’Œæ°´ï¼Œç‰¹åˆ«æ˜¯ä¸€äº›è¢«é—å¿˜çš„åŒºåŸŸã€‚æˆ‘ä»¬è¢«å‘ŠçŸ¥è¦æŒ‰ç…§ç¨‹åºåˆ†é…ç‰©èµ„ï¼Œè®¸å¤šåœ°æ–¹çš„ç¾æ°‘åœ¨ç­‰å¾…ç€æ•‘æ´",
                    text2: "æ‰€æœ‰è¢«å®‰ç½®çš„ç¾æ°‘éƒ½å¾—åˆ°äº†é£Ÿç‰©å’Œæ°´ï¼Œå¿—æ„¿è€…ä»¬ä¹ŸååŠ©äº†è®¸å¤šåœ°åŒºçš„æ•´ç†å·¥ä½œï¼Œæ¢å¤äº†å¤§éƒ¨åˆ†ç¤¾åŒºçš„ç§©åºã€‚"
                }
            };

            // æ·»åŠ é€‰æ‹©è®°å½•
            let choices = {
                unofficial: [], // å­˜å‚¨æœªå…¬å¼€ç‰ˆæœ¬çš„é€‰æ‹©
                official: []    // å­˜å‚¨å®˜æ–¹ç‰ˆæœ¬çš„é€‰æ‹©
            };

            // éšè—å¯¹è¯æ¡†çš„å‡½æ•°
            function hideDialogue() {
                dialogueBox.style.display = 'none';
                selectionResultBox.classList.remove('show'); // ç¡®ä¿é€‰æ‹©ç»“æœæ¡†ä¹Ÿéšè—
                // å¹³æ»‘éšè—é€‰æ‹©å®¹å™¨
                document.querySelector('.choice-container').classList.remove('show');
            }

            // æ˜¾ç¤ºå¯¹è¯å†…å®¹
            function showDialogue(btnId) {
                // å°†btn-1è½¬æ¢ä¸ºdialogue1æ ¼å¼
                const dialogueNum = btnId.split('-')[1];
                currentActiveDialogueNum = dialogueNum; // æ›´æ–°å½“å‰æ´»è·ƒçš„å¯¹è¯ç¼–å·
                dialogueText.innerHTML = `
                    <div style="margin-bottom: 20px;">
                        <div class="version-label">
                            <strong>ç‰ˆæœ¬ä¸€</strong> 
                            <span class="speaker-icon version1-speaker" data-dialogue-num="${dialogueNum}" style="cursor: pointer;">ğŸ”ˆ</span>
                        </div>
                        <p class="version-content">${dialogues[btnId].text1}</p>
                    </div>
                    <div>
                        <div class="version-label">
                            <strong>ç‰ˆæœ¬äºŒ</strong> 
                            <span class="speaker-icon version2-speaker" data-dialogue-num="${dialogueNum}" style="cursor: pointer;">ğŸ”ˆ</span>
                        </div>
                        <p class="version-content">${dialogues[btnId].text2}</p>
                    </div>
                `;
                dialogueBox.style.display = 'block';

                // 2ç§’åå¹³æ»‘æ˜¾ç¤ºé€‰æ‹©å®¹å™¨
                setTimeout(() => {
                    document.querySelector('.choice-container').classList.add('show');
                }, 2000);

                // åŠ¨æ€ç»‘å®šéŸ³é¢‘æ’­æ”¾äº‹ä»¶
                document.querySelectorAll('.version1-speaker').forEach(speaker => {
                    speaker.addEventListener('click', () => {
                        playVersion1Audio(speaker.dataset.dialogueNum);
                    });
                });
                document.querySelectorAll('.version2-speaker').forEach(speaker => {
                    speaker.addEventListener('click', () => {
                        playVersion2Audio(speaker.dataset.dialogueNum);
                    });
                });
            }

            // æ˜¾ç¤ºé€‰æ‹©ç»“æœæç¤ºæ¡†çš„å‡½æ•°
            function showSelectionResult(message) {
                selectionResultMessage.textContent = message;
                selectionResultBox.classList.add('show');
                // 1.5ç§’åè‡ªåŠ¨éšè—
                setTimeout(() => {
                    selectionResultBox.classList.remove('show');
                }, 1500);
            }

            // ä¸ºæ¯ä¸ªå¯¹è¯æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
            document.querySelectorAll('.dialogue-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    showDialogue(btn.classList[1]);
                });
            });

            // ä¸ºç‰ˆæœ¬æŒ‰é’®æ·»åŠ ç‚¹å‡»äº‹ä»¶
            unofficialBtn.addEventListener('click', function() {
                const currentDialogue = dialogueText.textContent;
                choices.unofficial.push(currentDialogue);
                localStorage.setItem('scene1Choices', JSON.stringify(choices));
                hideDialogue();
                
                let feedbackMessage;
                if (currentActiveDialogueNum === '1' || currentActiveDialogueNum === '2') {
                    feedbackMessage = "ä½ é€‰æ‹©çš„æ˜¯å®˜æ–¹ç‰ˆæœ¬"; // å¯¹è¯1å’Œ2çš„ç‰ˆæœ¬ä¸€æ˜¯å®˜æ–¹ç‰ˆæœ¬
                } else if (currentActiveDialogueNum === '3') {
                    feedbackMessage = "ä½ é€‰æ‹©çš„æ˜¯æœªå…¬å¼€ç‰ˆæœ¬"; // å¯¹è¯3çš„ç‰ˆæœ¬ä¸€æ˜¯æœªå…¬å¼€ç‰ˆæœ¬
                }
                showSelectionResult(feedbackMessage);
            });

            officialBtn.addEventListener('click', function() {
                const currentDialogue = dialogueText.textContent;
                choices.official.push(currentDialogue);
                localStorage.setItem('scene1Choices', JSON.stringify(choices));
                hideDialogue();

                let feedbackMessage;
                if (currentActiveDialogueNum === '1' || currentActiveDialogueNum === '2') {
                    feedbackMessage = "ä½ é€‰æ‹©çš„æ˜¯æœªå…¬å¼€ç‰ˆæœ¬"; // å¯¹è¯1å’Œ2çš„ç‰ˆæœ¬äºŒæ˜¯æœªå…¬å¼€ç‰ˆæœ¬
                } else if (currentActiveDialogueNum === '3') {
                    feedbackMessage = "ä½ é€‰æ‹©çš„æ˜¯å®˜æ–¹ç‰ˆæœ¬"; // å¯¹è¯3çš„ç‰ˆæœ¬äºŒæ˜¯å®˜æ–¹ç‰ˆæœ¬
                }
                showSelectionResult(feedbackMessage);
            });

            // å½“é¡µé¢éšè—æ—¶åªåœæ­¢å¯¹è¯éŸ³é¢‘
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    stopDialogueAudio();
                }
            });

            // å½“ç¦»å¼€é¡µé¢æ—¶åªåœæ­¢å¯¹è¯éŸ³é¢‘
            window.addEventListener('beforeunload', function() {
                stopDialogueAudio();
            });

            function updateDebugInfo(message) {
                debugInfo.textContent = message;
                console.log(message);
            }

            // è®¾ç½®è§†é¢‘å±æ€§
            video.muted = true;
            video.loop = true;
            video.playsInline = true;
            video.autoplay = true; // æ·»åŠ è‡ªåŠ¨æ’­æ”¾

            // ç›‘å¬è§†é¢‘ç»“æŸäº‹ä»¶
            video.addEventListener('ended', function() {
                updateDebugInfo('è§†é¢‘æ’­æ”¾å®Œæˆï¼Œå¼€å§‹å¾ªç¯');
            });

            // ç›‘å¬è§†é¢‘é”™è¯¯
            video.addEventListener('error', function(e) {
                updateDebugInfo(`è§†é¢‘é”™è¯¯: ${video.error.message}`);
            });

            // è‡ªåŠ¨æ’­æ”¾è§†é¢‘
            const playPromise = video.play();
            if (playPromise !== undefined) {
                playPromise.then(() => {
                    updateDebugInfo('è§†é¢‘å¼€å§‹æ’­æ”¾');
                }).catch(error => {
                    updateDebugInfo(`è§†é¢‘æ’­æ”¾å¤±è´¥: ${error.message}`);
                    console.error('è§†é¢‘æ’­æ”¾å¤±è´¥:', error);
                });
            }

            // è®¾ç½®èƒŒæ™¯éŸ³ä¹
            bgm.volume = 0.15; // è®¾ç½®éŸ³é‡ä¸º15%
            bgm.play().catch(error => {
                console.error('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
            });

            // å½“é¡µé¢éšè—æ—¶æš‚åœèƒŒæ™¯éŸ³ä¹
            document.addEventListener('visibilitychange', function() {
                if (document.hidden) {
                    bgm.pause();
                } else {
                    bgm.play().catch(error => {
                        console.error('èƒŒæ™¯éŸ³ä¹æ’­æ”¾å¤±è´¥:', error);
                    });
                }
            });

            // å½“ç¦»å¼€é¡µé¢æ—¶ä¿å­˜èƒŒæ™¯éŸ³ä¹çŠ¶æ€
            window.addEventListener('beforeunload', function() {
                localStorage.setItem('bgmTime', bgm.currentTime);
            });

            // æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„èƒŒæ™¯éŸ³ä¹æ’­æ”¾ä½ç½®
            const savedBgmTime = localStorage.getItem('bgmTime');
            if (savedBgmTime) {
                bgm.currentTime = parseFloat(savedBgmTime);
            }

            // æ·»åŠ ä¸‹ä¸€é¡µæŒ‰é’®ç‚¹å‡»äº‹ä»¶
            nextPageBtn.addEventListener('click', function() {
                // è¿™é‡Œå¯ä»¥æ·»åŠ è¿‡æ¸¡åŠ¨ç”»æˆ–å…¶ä»–æ•ˆæœ
                window.location.href = 'scene2.html';
            });
        });
    </script>
</body>
</html> 
